<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <title>配置 | Glide v4 中文站</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://muyangmin.github.io/glide-docs-cn/configuration.html">
  <!-- Alternative links -->
  
    
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/glide-docs-cn/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/glide-docs-cn/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/glide-docs-cn/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/glide-docs-cn/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/glide-docs-cn/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/glide-docs-cn/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/glide-docs-cn/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/glide-docs-cn/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/glide-docs-cn/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/glide-docs-cn/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/glide-docs-cn/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/glide-docs-cn/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/glide-docs-cn/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/glide-docs-cn/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/glide-docs-cn/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css">
  <!-- RSS -->
  <link rel="alternate" href="/glide-docs-cn/atom.xml" title="Glide v4 中文站">
  <!-- Open Graph -->
  <!-- <meta name="description" content="原文链接：点击查看 设置为了让Glide正常工作，库和应用程序需要做一些固定的步骤。不过，假如你的库不希望注册额外的组件，则这些初始化不是必须的。 程序库程序库(Libraries)需要：  添加一个或多个[LibraryGlideModule][2]实现。 为每一个[LibraryGlideModule][2]实现添加[@GlideModule][5]注解。 添加Glide的注解解析器的依赖。">
<meta property="og:type" content="website">
<meta property="og:title" content="配置">
<meta property="og:url" content="https://muyangmin.github.io/glide-docs-cn/configuration.html">
<meta property="og:site_name" content="Glide v4 中文站">
<meta property="og:description" content="原文链接：点击查看 设置为了让Glide正常工作，库和应用程序需要做一些固定的步骤。不过，假如你的库不希望注册额外的组件，则这些初始化不是必须的。 程序库程序库(Libraries)需要：  添加一个或多个[LibraryGlideModule][2]实现。 为每一个[LibraryGlideModule][2]实现添加[@GlideModule][5]注解。 添加Glide的注解解析器的依赖。">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2017-09-12T06:55:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="配置">
<meta name="twitter:description" content="原文链接：点击查看 设置为了让Glide正常工作，库和应用程序需要做一些固定的步骤。不过，假如你的库不希望注册额外的组件，则这些初始化不是必须的。 程序库程序库(Libraries)需要：  添加一个或多个[LibraryGlideModule][2]实现。 为每一个[LibraryGlideModule][2]实现添加[@GlideModule][5]注解。 添加Glide的注解解析器的依赖。"> -->
</head>

<body>
  <div id="container">
    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">配置</h1>
                
              </header>
              <div class="article-content" itemprop="articleBody">
                <p>原文链接：<a href="http://bumptech.github.io/glide/doc/configuration.html" target="_blank" rel="external">点击查看</a></p>
<h3 id="设置" class="article-heading"><a href="#设置" class="headerlink" title="设置"></a>设置<a class="article-anchor" href="#设置" aria-hidden="true"></a></h3><p>为了让Glide正常工作，库和应用程序需要做一些固定的步骤。不过，假如你的库不希望注册额外的组件，则这些初始化不是必须的。</p>
<h4 id="程序库" class="article-heading"><a href="#程序库" class="headerlink" title="程序库"></a>程序库<a class="article-anchor" href="#程序库" aria-hidden="true"></a></h4><p>程序库(Libraries)需要：</p>
<ol>
<li>添加一个或多个[<code>LibraryGlideModule</code>][2]实现。</li>
<li>为每一个[<code>LibraryGlideModule</code>][2]实现添加[<code>@GlideModule</code>][5]注解。</li>
<li>添加Glide的注解解析器的依赖。</li>
</ol>
<p>An example [<code>LibraryGlideModule</code>][2] from Glide’s [OkHttp integration library][7] looks like this<br>在Glide的[OkHttp 集成库][7]中有一个[<code>LibraryGlideModule</code>][2]的示例实现，它看起来长这样：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">OkHttpLibraryGlideModule</span> <span class="keyword">extends</span> <span class="title">LibraryGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerComponents</span><span class="params">(Context context, Registry registry)</span> </span>&#123;</div><div class="line">    registry.replace(GlideUrl.class, InputStream.class, <span class="keyword">new</span> OkHttpUrlLoader.Factory());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>要使用[<code>@GlideModule</code>][5]注解，需要有对Glide注解的依赖：<br><figure class="highlight groovy"><table><tr><td class="code"><pre><div class="line">compile <span class="string">'com.github.bumptech.glide:annotations:4.0.0'</span></div></pre></td></tr></table></figure></p>
<h4 id="应用程序" class="article-heading"><a href="#应用程序" class="headerlink" title="应用程序"></a>应用程序<a class="article-anchor" href="#应用程序" aria-hidden="true"></a></h4><p>应用程序(Applications)需要：</p>
<ol>
<li>恰当地添加一个[<code>AppGlideModule</code>][1]实现。</li>
<li>(可选)添加一个或多个[<code>LibraryGlideModule</code>][2]实现。</li>
<li>给上述两种实现添加[<code>@GlideModule</code>][5]注解。</li>
<li>添加对Glide的注解解析器的依赖。</li>
<li>在proguard中，添加对[<code>AppGlideModules</code>][1]的keep。</li>
</ol>
<p>在Glide的[Flickr 示例应用][8]中，有一个[<code>AppGlideModule</code>][1]的示例实现：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlickrGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerComponents</span><span class="params">(Context context, Registry registry)</span> </span>&#123;</div><div class="line">    registry.append(Photo.class, InputStream.class, <span class="keyword">new</span> FlickrModelLoader.Factory());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>请注意添加对Glide的注解和注解解析器的依赖：<br><figure class="highlight groovy"><table><tr><td class="code"><pre><div class="line">compile <span class="string">'com.github.bumptech.glideannotations4.0.0'</span></div><div class="line">annotationProcessor <span class="string">'com.github.bumptech.glidecompiler4.0.0'</span></div></pre></td></tr></table></figure></p>
<p>最后，你应该在你的<code>proguard.cfg</code>中keep住你的AppGlideModule实现：<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">-keep public class  extends com.bumptech.glide.module.AppGlideModule</div><div class="line">-keep class com.bumptech.glide.GeneratedAppGlideModuleImpl</div></pre></td></tr></table></figure></p>
<h3 id="应用程序选项" class="article-heading"><a href="#应用程序选项" class="headerlink" title="应用程序选项"></a>应用程序选项<a class="article-anchor" href="#应用程序选项" aria-hidden="true"></a></h3><p>Glide允许应用通过[<code>AppGlideModule</code>][1]实现来完全控制Glide的内存和磁盘缓存使用。Glide试图提供对大部分应用程序合理的默认选项，但对于部分应用，可能就需要定制这些值。在你做任何改变时，请注意测量其结果，避免出现性能的倒退。</p>
<h4 id="内存缓存" class="article-heading"><a href="#内存缓存" class="headerlink" title="内存缓存"></a>内存缓存<a class="article-anchor" href="#内存缓存" aria-hidden="true"></a></h4><p>默认情况下，Glide使用[<code>LruResourceCache</code>][10]，这是[<code>MemoryCache</code>][9]接口的一个缺省实现，使用固定大小的内存和LRU算法。[<code>LruResourceCache</code>][10]的大小由Glide的[<code>MemorySizeCalculator</code>][11]类来决定，这个类主要关注设备的内存类型，设备RAM大小，以及屏幕分辨率。</p>
<p>应用程序可以自定义[<code>MemoryCache</code>][9]的大小，具体是在它们的[<code>AppGlideModule</code>][1]中使用[<code>applyOptions(Context, GlideBuilder)</code>][12]方法配置[<code>MemorySizeCalculator</code>][11]：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    MemorySizeCalculator calculator = <span class="keyword">new</span> MemorySizeCalculator.Builder(context)</div><div class="line">        .setMemoryCacheScreens(<span class="number">2</span>)</div><div class="line">        .build();</div><div class="line">    builder.setMemoryCache(<span class="keyword">new</span> LruResourceCache(calculator.getMemoryCacheSize()));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>也可以直接覆写缓存大小：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> memoryCacheSizeBytes = <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">20</span>; <span class="comment">// 20mb</span></div><div class="line">    builder.setMemoryCache(<span class="keyword">new</span> LruResourceCache(memoryCacheSizeBytes));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>甚至可以提供自己的[<code>MemoryCache</code>][9]实现：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    builder.setMemoryCache(<span class="keyword">new</span> YourAppMemoryCacheImpl());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="磁盘缓存" class="article-heading"><a href="#磁盘缓存" class="headerlink" title="磁盘缓存"></a>磁盘缓存<a class="article-anchor" href="#磁盘缓存" aria-hidden="true"></a></h4><p>Glide使用[<code>DiskLruCacheWrapper</code>][13]作为默认的[<code>磁盘缓存</code>][14]。[<code>DiskLruCacheWrapper</code>][13]是一个使用LRU算法的固定大小的磁盘缓存。默认磁盘大小为[250 MB][15]，位置是在应用的[缓存文件夹][17]中的一个[特定目录][16]。</p>
<p>假如应用程序展示的媒体内容是公开的（从无授权机制的网站上加载，或搜索引擎等），那么应用可以将这个缓存位置改到外部存储：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    builder.setDiskCache(<span class="keyword">new</span> ExternalDiskCacheFactory(context));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>无论使用内部或外部磁盘缓存，应用程序都可以改变磁盘缓存的大小：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> diskCacheSizeBytes = <span class="number">1024</span>  <span class="number">1024</span>  <span class="number">100</span>;  <span class="number">100</span> MB</div><div class="line">    builder.setDiskCache(<span class="keyword">new</span> InternalDiskCacheFactory(context, diskCacheSizeBytes));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>应用程序还可以改变缓存文件夹在外存或内存上的名字：<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> diskCacheSizeBytes = <span class="number">1024</span>  <span class="number">1024</span>  <span class="number">100</span>;  <span class="number">100</span> MB</div><div class="line">    builder.setDiskCache(</div><div class="line">        <span class="keyword">new</span> InternalDiskCacheFactory(context, cacheFolderName, diskCacheSizeBytes));</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>应用程序还可以自行选择[<code>DiskCache</code>][14]接口的实现，并提供自己的[<code>DiskCache.Factory</code>][18]来创建缓存。Glide使用一个工厂接口来在后台线程中打开[<code>磁盘缓存</code>][14]，这样方便缓存做诸如检查路径存在性等的IO操作而不用触发[严格模式][19]。<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">applyOptions</span><span class="params">(Context context, GlideBuilder builder)</span> </span>&#123;</div><div class="line">    builder.setDiskCache(<span class="keyword">new</span> DiskCache.Factory() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> DiskCache <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> YourAppCustomDiskCache();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="注册组件" class="article-heading"><a href="#注册组件" class="headerlink" title="注册组件"></a>注册组件<a class="article-anchor" href="#注册组件" aria-hidden="true"></a></h3><p>应用程序和库都可以注册很多组件来扩展Glide的功能。可用的组件包括：</p>
<ol>
<li>[<code>ModelLoader</code>][23], 用于加载自定义的Model(Url, Uri,任意的POJO)和Data(InputStreams, FileDescriptors)。</li>
<li>[<code>ResourceDecoder</code>][24], 用于对新的Resources(Drawables, Bitmaps)或新的Data类型(InputStreams, FileDescriptors)进行解码。</li>
<li>[<code>Encoder</code>][25], 用于向Glide的磁盘缓存写Data (InputStreams, FileDesciptors)。</li>
<li>[<code>ResourceTranscoder</code>][26]，用于在不同的资源类型之间做转换，例如，从BitmapResource转换为DrawableResource。</li>
<li>[<code>ResourceEncoder</code>][27]，用于向Glide的磁盘缓存写Resources(BitmapResource, DrawableResource)。</li>
</ol>
<p>组件通过[<code>Registry</code>][28]类来注册。例如，添加一个<code>ModelLoader</code>，使其能从自定义的Model对象中创建一个InputStream：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YourAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerComponents</span><span class="params">(Context context, Registry registry)</span> </span>&#123;</div><div class="line">    registry.append(Photo.class, InputStream.class, <span class="keyword">new</span> CustomModelLoader.Factory());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在一个<code>GlideModule</code>里可以注册很多组件。[<code>ModelLoader</code>][23]和[<code>ResourceDecoder</code>][24]对于同样的参数类型还可以有多种实现。</p>
<p>被注册组件的集合（包括默认被Glide注册的和在Moduke中被注册的），会被用于定义一个加载路径集合。每个加载路径都是从提供给[<code>load</code>][29]方法的数据模型到[<code>as</code>][30]方法指定的资源类型的一个逐步演进的过程。一个加载路径（粗略地）由下列步骤组成:</p>
<ol>
<li>模型(Model) -&gt; 数据(Data) (由<code>模型加载器(ModelLoader)</code>处理)</li>
<li>数据(Data)  -&gt; 资源(Resource) (由<code>资源解析器(ResourceDecoder)</code>处理)</li>
<li>资源(Resource) -&gt; 转码后的资源(Transcoded Resource) (可选；由<code>资源转码器(ResourceTranscoder)</code>处理)</li>
</ol>
<p><code>编码器(Encoder)</code>可以在步骤2之前往Glide的磁盘缓存中写入数据。<br> <code>资源编码器(ResourceEncoder)</code>可以在步骤3之前网Glide的磁盘缓存写入资源。</p>
<p>当一个请求开始后，Glide将尝试所有从数据模型到请求的资源类型的可用路径。如果任何一个加载路径成功，这个请求就将成功。只有所有可用加载路径都失败时，这个请求才会失败。</p>
<p>在[<code>Registry</code>][28]类中定义了<code>prepend()</code>, <code>append()</code> 和<code>replace()</code>方法，它们可以用于设置Glide尝试每个<code>ModelLoader</code>和<code>ResourceDecoder</code>之间的顺序。通过确保优先注册处理最常见类型的<code>ModelLoader</code>和<code>ResourceDecoder</code>，可以使请求更高效。对组件进行排序还意味着允许你注册一些只处理特定树模型的子集的组件（即只处理特定类型的Uri，或仅仅特定类型的图像格式），但还能在后面追加一个捕获所有类型的组件以处理其他情况。</p>
<h3 id="模块类和注解" class="article-heading"><a href="#模块类和注解" class="headerlink" title="模块类和注解"></a>模块类和注解<a class="article-anchor" href="#模块类和注解" aria-hidden="true"></a></h3><p>Glide v4 依赖于两种类，[<code>AppGlideModule</code>][1]与[<code>LibraryGlideModule</code>][2]，以配置Glide单例。这两种类都允许用于注册额外的组件，例如[<code>ModelLoaders</code>][3], [<code>ResourceDecoders</code>][4]等。但只有[<code>AppGlideModule</code>][1]被允许配置应用特定的设置项，比如缓存实现和缓存大小。</p>
<h4 id="AppGlideModule" class="article-heading"><a href="#AppGlideModule" class="headerlink" title="AppGlideModule"></a>AppGlideModule<a class="article-anchor" href="#AppGlideModule" aria-hidden="true"></a></h4><p>所有应用都必须添加一个[<code>AppGlideModule</code>][1]实现，即使应用并没有改变任何附加设置项，也没有实现[<code>AppGlideModule</code>][1]中的任何方法。 [<code>AppGlideModule</code>][1]实现是一个信号，它会让Glide的注解解析器生成一个单一的所有已发现的[<code>LibraryGlideModules</code>][2]的联合类。</p>
<p>对于一个特定的应用，只能存在一个[<code>AppGlideModule</code>][1]实现（超过一个会在编译时报错）。因此，程序库不能提供[<code>AppGlideModule</code>][1]实现。</p>
<h4 id="GlideModule" class="article-heading"><a href="#GlideModule" class="headerlink" title="@GlideModule"></a>@GlideModule<a class="article-anchor" href="#GlideModule" aria-hidden="true"></a></h4><p>为了让Glide正确地发现[<code>AppGlideModule</code>][1]和[<code>LibraryGlideModule</code>][2]的实现类，它们的所有实现都必须使用[<code>@GlideModule</code>][5]注解来标记。这个注解将允许Glide的[注解解析器][6]在编译时去发现所有的实现类。</p>
<h4 id="注解处理器" class="article-heading"><a href="#注解处理器" class="headerlink" title="注解处理器"></a>注解处理器<a class="article-anchor" href="#注解处理器" aria-hidden="true"></a></h4><p>另外，为了发现[<code>AppGlideModule</code>][1] 和 [<code>LibraryGlideModules</code>][2]，所有的库和应用还必须包含一个Glide的注解解析器的依赖。</p>
<h3 id="冲突" class="article-heading"><a href="#冲突" class="headerlink" title="冲突"></a>冲突<a class="article-anchor" href="#冲突" aria-hidden="true"></a></h3><p>应用程序可能依赖多个程序库，而它们每一个都可能包含一个或更多的[<code>LibraryGlideModules</code>][2]。在极端情况下，这些[<code>LibraryGlideModules</code>][2]可能定义了相互冲突的选项，或者包含了应用程序希望避免的行为。应用程序可以通过给他们的[<code>AppGlideModule</code>][1]添加一个[<code>@Excludes</code>][20]注解来解决这种冲突，或避免不需要的依赖。</p>
<p>例如，如果你依赖了一个库，它有一个[<code>LibraryGlideModule</code>][2]叫做<code>com.example.unwanted.GlideModule</code>，而你不想要它：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Excludes</span>(com.example.unwanted.GlideModule)</div><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p>你也可以排除多个模块：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@Excludes</span>(&#123;com.example.unwanted.GlideModule, com.example.conflicing.GlideModule&#125;)</div><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123; &#125;</div></pre></td></tr></table></figure>
<p><code>@Excludes</code>][20]注解不仅可用于排除[<code>LibraryGlideModules</code>][2]。如果你还在从Glide v3到新版本的迁移过程中，你还可以用它来排除旧的，废弃的[<code>GlideModule</code>][21]实现。</p>
<h3 id="清单解析" class="article-heading"><a href="#清单解析" class="headerlink" title="清单解析"></a>清单解析<a class="article-anchor" href="#清单解析" aria-hidden="true"></a></h3><p>为了维持对Glide v3的[<code>GlideModules</code>][21]的向后兼容性，Glide仍然会解析应用程序和所有被包含的库中的<code>AndroidManifest.xml</code>文件，并包含在这些清单中列出的旧 [<code>GlideModules</code>][21]模块类。</p>
<p>如果你已经迁移到Glide v4的[<code>AppGlideModule</code>][1] 和 [<code>LibraryGlideModule</code>][2]，你可以完全禁用清单解析。这样可以改善Glide的初始启动时间，并避免尝试解析元数据时的一些潜在问题。要禁用清单解析，请在你的[<code>AppGlideModule</code>][1]实现中复写[<code>isManifestParsingEnabled()</code>][22]方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line"><span class="meta">@GlideModule</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAppGlideModule</span> <span class="keyword">extends</span> <span class="title">AppGlideModule</span> </span>&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isManifestParsingEnabled</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>[1] glidejavadocs400combumptechglidemoduleAppGlideModule.html<br>[2] glidejavadocs400combumptechglidemoduleLibraryGlideModule.html<br>[3] glidejavadocs400combumptechglideloadmodelModelLoader.html<br>[4] glidejavadocs400combumptechglideloadResourceDecoder.html<br>[5] glidejavadocs400combumptechglideannotationGlideModule.html<br>[6] glidejavadocs400combumptechglideannotationcompilerGlideAnnotationProcessor.html<br>[7] httpsgithub.combumptechglideblobmasterintegrationokhttp3srcmainjavacombumptechglideintegrationokhttp3OkHttpLibraryGlideModule.java<br>[8] httpsgithub.combumptechglideblobmastersamplesflickrsrcmainjavacombumptechglidesamplesflickrFlickrGlideModule.java<br>[9] glidejavadocs400combumptechglideloadenginecacheMemoryCache.html<br>[10] glidejavadocs400combumptechglideloadenginecacheLruResourceCache.html<br>[11] glidejavadocs400combumptechglideloadenginecacheMemorySizeCalculator.html<br>[12] glidejavadocs400combumptechglidemoduleAppGlideModule.html#applyOptions-android.content.Context-com.bumptech.glide.GlideBuilder-<br>[13] glidejavadocs400combumptechglideloadenginecacheDiskLruCacheWrapper.html<br>[14] glidejavadocs400combumptechglideloadenginecacheDiskCache.html<br>[15] glidejavadocs400combumptechglideloadenginecacheDiskCache.Factory.html#DEFAULT_DISK_CACHE_SIZE<br>[16] glidejavadocs400combumptechglideloadenginecacheDiskCache.Factory.html#DEFAULT_DISK_CACHE_DIR<br>[17] httpsdeveloper.android.comreferenceandroidcontentContext.html#getCacheDir()<br>[18] glidejavadocs400combumptechglideloadenginecacheDiskCache.Factory.html<br>[19] httpsdeveloper.android.comreferenceandroidosStrictMode.html<br>[20] glidejavadocs400combumptechglideannotationExcludes.html<br>[21] glidejavadocs400combumptechglidemoduleGlideModule.html<br>[22] glidejavadocs400combumptechglidemoduleAppGlideModule.html#isManifestParsingEnabled–<br>[23] glidejavadocs400combumptechglideloadmodelModelLoaderFactory.html<br>[24] glidejavadocs400combumptechglideloadResourceDecoder.html<br>[25] glidejavadocs400combumptechglideloadEncoder.html<br>[26] glidejavadocs400combumptechglideloadresourcetranscodeResourceTranscoder.html<br>[27] glidejavadocs400combumptechglideloadResourceEncoder.html<br>[28] glidejavadocs400combumptechglideRegistry.html<br>[29] glidejavadocs400combumptechglideRequestBuilder.html#load-java.lang.Object-<br>[30] glidejavadocs400combumptechglideRequestManager.html#as-java.lang.Class-</p>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2017-09-12T06:55:41.000Z" itemprop="dateModified">上次更新：2017-09-12</time>
                
              </footer>
            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#设置"><span class="toc-text">设置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#程序库"><span class="toc-text">程序库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#应用程序"><span class="toc-text">应用程序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用程序选项"><span class="toc-text">应用程序选项</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#内存缓存"><span class="toc-text">内存缓存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#磁盘缓存"><span class="toc-text">磁盘缓存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册组件"><span class="toc-text">注册组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模块类和注解"><span class="toc-text">模块类和注解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#AppGlideModule"><span class="toc-text">AppGlideModule</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#GlideModule"><span class="toc-text">@GlideModule</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#注解处理器"><span class="toc-text">注解处理器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#冲突"><span class="toc-text">冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#清单解析"><span class="toc-text">清单解析</span></a></li></ol>
              <a href="#" id="article-toc-top">回到顶部</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">首页</strong><a href="index.html" class="sidebar-link">关于Glides</a><strong class="sidebar-title">文档</strong><a href="download-setup.html" class="sidebar-link">下载和初始化</a><a href="getting-started.html" class="sidebar-link">开始使用</a><a href="generatedapi.html" class="sidebar-link">生成的API</a><a href="placeholders.html" class="sidebar-link">占位符</a><a href="options.html" class="sidebar-link">选项</a><a href="transformations.html" class="sidebar-link">变换</a><a href="targets.html" class="sidebar-link">目标</a><a href="transitions.html" class="sidebar-link">过渡</a><a href="configuration.html" class="sidebar-link current">配置</a><a href="caching.html" class="sidebar-link">缓存</a><a href="debugging.html" class="sidebar-link">调试</a><a href="migrating.html" class="sidebar-link">从v3迁移到v4</a><strong class="sidebar-title">其他指南</strong><a href="http://bumptech.github.io/glide/ref/javadocs.html" class="sidebar-link">Javadocs</a><a href="samples.html" class="sidebar-link">示例项目</a><strong class="sidebar-title">集成库</strong><a href="about.html" class="sidebar-link">关于集成库</a><a href="okhttp3.html" class="sidebar-link">OkHttp3</a><a href="volley.html" class="sidebar-link">Volley</a><a href="recyclerview.html" class="sidebar-link">RecyclerView</a><strong class="sidebar-title">开发者</strong><a href="snapshots.html" class="sidebar-link">快照版本</a><a href="contributing.html" class="sidebar-link">贡献代码或文档</a><a href="http://bumptech.github.io/glide/dev/open-source-licenses.html" class="sidebar-link">开源许可证</a>
  </div>
</aside>
    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2017 <a href="https://github.com/Muyangmin/glide-docs-cn/graphs/contributors" target="_blank">Muyangmin</a><br>
      Documentation licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      

      
      <a href="https://github.com/Muyangmin/glide-docs-cn" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
      
    </div>
  </div>
</footer>

  </div>
  <!-- Scripts -->
<!-- build:js build/js/main.js -->
<script src="/glide-docs-cn/js/toc.js"></script>
<!-- endbuild -->
</body>
</html>